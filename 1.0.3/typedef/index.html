<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../">
  <title data-ice="title">Typedef | Autonym</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  <script src="script/manual.js"></script>
<link rel="stylesheet" href="https://unpkg.com/codemirror@5/lib/codemirror.css">
<link rel="stylesheet" href="assets/docsAssets/styles.css">
<meta name="description" content="A KISS JSON REST API framework that can be mounted to your Express application."><meta property="twitter:card" content="summary"><meta property="twitter:title" content="Autonym"><meta property="twitter:description" content="A KISS JSON REST API framework that can be mounted to your Express application."></head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
<a style="position:relative; top:3px;" href="https://github.com/mmiller42/autonym"><img width="20px" src="./image/github.png"></a></header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  <li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/AutonymError.js~AutonymError.html">AutonymError</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/Model.js~Model.html">Model</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/Req.js~Req.html">Req</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/src/Res.js~Res.html">Res</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-createInMemoryStore">createInMemoryStore</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-createModelMiddleware">createModelMiddleware</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-createResponderMiddleware">createResponderMiddleware</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-AjvOptions">AjvOptions</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-AndExpression">AndExpression</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-Meta">Meta</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-ModelPolicies">ModelPolicies</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-NotExpression">NotExpression</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-Operand">Operand</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-OrExpression">OrExpression</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-Policy">Policy</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-Record">Record</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-Schema">Schema</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-SerializedRecord">SerializedRecord</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-typedef">T</span><span data-ice="name"><span><a href="typedef/index.html#static-typedef-Store">Store</a></span></span></li>
</ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">Typedef</h1>
<div data-ice="summaries"><table class="summary" data-ice="summary">
  <thead><tr><td data-ice="title" colspan="3">Static Public Summary</td></tr></thead>
  <tbody>
  
  <tr data-ice="target">
    <td>
      <span class="access" data-ice="access">public</span>
      
      
      
      <span class="override" data-ice="override"></span>
    </td>
    <td>
      <div>
        <p>
          
          
          
          <span class="code" data-ice="name"><span><a href="typedef/index.html#static-typedef-AjvOptions">AjvOptions</a></span></span><span class="code" data-ice="signature">: <span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a></span></span>
        </p>
      </div>
      <div>
        
        
        <div data-ice="description"><p>Options to pass to the JSON schema validator.</p>
</div>
      </div>
    </td>
    <td>
      
      
    </td>
  </tr>
<tr data-ice="target">
    <td>
      <span class="access" data-ice="access">public</span>
      
      
      
      <span class="override" data-ice="override"></span>
    </td>
    <td>
      <div>
        <p>
          
          
          
          <span class="code" data-ice="name"><span><a href="typedef/index.html#static-typedef-AndExpression">AndExpression</a></span></span><span class="code" data-ice="signature">: <span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a></span></span>
        </p>
      </div>
      <div>
        
        
        <div data-ice="description"><p>An object with the key <code>and</code> set to an array of Operands.</p>
</div>
      </div>
    </td>
    <td>
      
      
    </td>
  </tr>
<tr data-ice="target">
    <td>
      <span class="access" data-ice="access">public</span>
      
      
      
      <span class="override" data-ice="override"></span>
    </td>
    <td>
      <div>
        <p>
          
          
          
          <span class="code" data-ice="name"><span><a href="typedef/index.html#static-typedef-Meta">Meta</a></span></span><span class="code" data-ice="signature">: <span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a></span></span>
        </p>
      </div>
      <div>
        
        
        <div data-ice="description"><p>A plain object that is shared for the given request.</p>
</div>
      </div>
    </td>
    <td>
      
      
    </td>
  </tr>
<tr data-ice="target">
    <td>
      <span class="access" data-ice="access">public</span>
      
      
      
      <span class="override" data-ice="override"></span>
    </td>
    <td>
      <div>
        <p>
          
          
          
          <span class="code" data-ice="name"><span><a href="typedef/index.html#static-typedef-ModelPolicies">ModelPolicies</a></span></span><span class="code" data-ice="signature">: <span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a></span></span>
        </p>
      </div>
      <div>
        
        
        <div data-ice="description"><p>An object mapping store method names to policy hooks.</p>
</div>
      </div>
    </td>
    <td>
      
      
    </td>
  </tr>
<tr data-ice="target">
    <td>
      <span class="access" data-ice="access">public</span>
      
      
      
      <span class="override" data-ice="override"></span>
    </td>
    <td>
      <div>
        <p>
          
          
          
          <span class="code" data-ice="name"><span><a href="typedef/index.html#static-typedef-NotExpression">NotExpression</a></span></span><span class="code" data-ice="signature">: <span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a></span></span>
        </p>
      </div>
      <div>
        
        
        <div data-ice="description"><p>An object with the key <code>not</code> set to an Operand.</p>
</div>
      </div>
    </td>
    <td>
      
      
    </td>
  </tr>
<tr data-ice="target">
    <td>
      <span class="access" data-ice="access">public</span>
      
      
      
      <span class="override" data-ice="override"></span>
    </td>
    <td>
      <div>
        <p>
          
          
          
          <span class="code" data-ice="name"><span><a href="typedef/index.html#static-typedef-Operand">Operand</a></span></span><span class="code" data-ice="signature">: <span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean">boolean</a></span> | <span><a href="typedef/index.html#static-typedef-Policy">Policy</a></span> | <span><a href="typedef/index.html#static-typedef-AndExpression">AndExpression</a></span> | <span><a href="typedef/index.html#static-typedef-OrExpression">OrExpression</a></span> | <span><a href="typedef/index.html#static-typedef-NotExpression">NotExpression</a></span></span>
        </p>
      </div>
      <div>
        
        
        <div data-ice="description"><p>An operand is a boolean (to explicitly allow or deny) or a policy function, or an AndExpression, OrExpression, or
NotExpression, which can be used to assemble more complex policies out of a series of policy functions.</p>
</div>
      </div>
    </td>
    <td>
      
      
    </td>
  </tr>
<tr data-ice="target">
    <td>
      <span class="access" data-ice="access">public</span>
      
      
      
      <span class="override" data-ice="override"></span>
    </td>
    <td>
      <div>
        <p>
          
          
          
          <span class="code" data-ice="name"><span><a href="typedef/index.html#static-typedef-OrExpression">OrExpression</a></span></span><span class="code" data-ice="signature">: <span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a></span></span>
        </p>
      </div>
      <div>
        
        
        <div data-ice="description"><p>An object with the key <code>or</code> set to an array of Operands.</p>
</div>
      </div>
    </td>
    <td>
      
      
    </td>
  </tr>
<tr data-ice="target">
    <td>
      <span class="access" data-ice="access">public</span>
      
      
      
      <span class="override" data-ice="override"></span>
    </td>
    <td>
      <div>
        <p>
          
          
          
          <span class="code" data-ice="name"><span><a href="typedef/index.html#static-typedef-Policy">Policy</a></span></span><span class="code" data-ice="signature">: <span><span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function">function</a></span><span>(req: <span>AutonymReq</span>, res: <span>AutonymRes</span>, meta: <span><a href="typedef/index.html#static-typedef-Meta">Meta</a></span>)</span>: <span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise">Promise</a></span>&lt;<span>*</span>, <span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error">Error</a></span>&gt;</span> | <span>*</span></span>
        </p>
      </div>
      <div>
        
        
        <div data-ice="description"><p>A function that is evaluated before a store method.</p>
</div>
      </div>
    </td>
    <td>
      
      
    </td>
  </tr>
<tr data-ice="target">
    <td>
      <span class="access" data-ice="access">public</span>
      
      
      
      <span class="override" data-ice="override"></span>
    </td>
    <td>
      <div>
        <p>
          
          
          
          <span class="code" data-ice="name"><span><a href="typedef/index.html#static-typedef-Record">Record</a></span></span><span class="code" data-ice="signature">: <span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a></span></span>
        </p>
      </div>
      <div>
        
        
        <div data-ice="description"><p>An object that represents a record that may be operated on by a model.</p>
</div>
      </div>
    </td>
    <td>
      
      
    </td>
  </tr>
<tr data-ice="target">
    <td>
      <span class="access" data-ice="access">public</span>
      
      
      
      <span class="override" data-ice="override"></span>
    </td>
    <td>
      <div>
        <p>
          
          
          
          <span class="code" data-ice="name"><span><a href="typedef/index.html#static-typedef-Schema">Schema</a></span></span><span class="code" data-ice="signature">: <span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a></span></span>
        </p>
      </div>
      <div>
        
        
        <div data-ice="description"><p>A JSON schema object.</p>
</div>
      </div>
    </td>
    <td>
      
      
    </td>
  </tr>
<tr data-ice="target">
    <td>
      <span class="access" data-ice="access">public</span>
      
      
      
      <span class="override" data-ice="override"></span>
    </td>
    <td>
      <div>
        <p>
          
          
          
          <span class="code" data-ice="name"><span><a href="typedef/index.html#static-typedef-SerializedRecord">SerializedRecord</a></span></span><span class="code" data-ice="signature">: <span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a></span></span>
        </p>
      </div>
      <div>
        
        
        <div data-ice="description"><p>A Record that has been transformed by the serialize function as a matter of convenience.</p>
</div>
      </div>
    </td>
    <td>
      
      
    </td>
  </tr>
<tr data-ice="target">
    <td>
      <span class="access" data-ice="access">public</span>
      
      
      
      <span class="override" data-ice="override"></span>
    </td>
    <td>
      <div>
        <p>
          
          
          
          <span class="code" data-ice="name"><span><a href="typedef/index.html#static-typedef-Store">Store</a></span></span><span class="code" data-ice="signature">(serialize: <span><span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function">function</a></span><span>(data: <span><a href="typedef/index.html#static-typedef-Record">Record</a></span>)</span>: <span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise">Promise</a></span>&lt;<span><a href="typedef/index.html#static-typedef-SerializedRecord">SerializedRecord</a></span>, <span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error">Error</a></span>&gt;</span> | <span><a href="typedef/index.html#static-typedef-SerializedRecord">SerializedRecord</a></span>, unserialize: <span><span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function">function</a></span><span>(data: <span><a href="typedef/index.html#static-typedef-SerializedRecord">SerializedRecord</a></span>)</span>: <span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise">Promise</a></span>&lt;<span><a href="typedef/index.html#static-typedef-Record">Record</a></span>, <span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error">Error</a></span>&gt;</span> | <span><a href="typedef/index.html#static-typedef-Record">Record</a></span>): <span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a></span></span>
        </p>
      </div>
      <div>
        
        
        <div data-ice="description"><p>An object that has methods for CRUD operations for a typical record.</p>
</div>
      </div>
    </td>
    <td>
      
      
    </td>
  </tr>
</tbody>
</table>
</div>
<div data-ice="details"><h2 data-ice="title">Static Public </h2>

<div class="detail" data-ice="detail">
  <h3 data-ice="anchor" id="static-typedef-AjvOptions">
    <span class="access" data-ice="access">public</span>
    
    
    
    
    
    <span class="code" data-ice="name">AjvOptions</span><span class="code" data-ice="signature">: <span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a></span></span>
    <span class="right-info">
      
      
      <span data-ice="source"><span><a href="file/src/_typeDefs.js.html#lineNumberundefined">source</a></span></span>
    </span>
  </h3>

  
  
  
  <div data-ice="description"><p>Options to pass to the JSON schema validator. <a href="https://github.com/epoberezkin/ajv#options">See options</a></p>
</div>

  

  <div data-ice="properties">
</div>

  

  

  

  

  

  

  

  
  
</div>
<div class="detail" data-ice="detail">
  <h3 data-ice="anchor" id="static-typedef-AndExpression">
    <span class="access" data-ice="access">public</span>
    
    
    
    
    
    <span class="code" data-ice="name">AndExpression</span><span class="code" data-ice="signature">: <span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a></span></span>
    <span class="right-info">
      
      
      <span data-ice="source"><span><a href="file/src/_typeDefs.js.html#lineNumberundefined">source</a></span></span>
    </span>
  </h3>

  
  
  
  <div data-ice="description"><p>An object with the key <code>and</code> set to an array of Operands. The expression will only evaluate to true if none of
the operands are false or throw errors. The error of the first policy to throw will be used, and short-circuiting
will prevent further policies from executing when one throws.</p>
</div>

  

  <div data-ice="properties"><div data-ice="properties">
  <h4 data-ice="title">Properties:</h4>
  <table class="params">
    <thead>
    <tr><td>Name</td><td>Type</td><td>Attribute</td><td>Description</td></tr>
    </thead>
    <tbody>
    
    <tr data-ice="property" data-depth="0">
      <td data-ice="name" class="code" data-depth="0">and</td>
      <td data-ice="type" class="code"><span><span><a href="typedef/index.html#static-typedef-Operand">Operand</a></span><span>[]</span></span></td>
      <td data-ice="appendix"></td>
      <td data-ice="description"></td>
    </tr>
</tbody>
  </table>
</div>
</div>

  

  

  

  

  

  

  

  
  
</div>
<div class="detail" data-ice="detail">
  <h3 data-ice="anchor" id="static-typedef-Meta">
    <span class="access" data-ice="access">public</span>
    
    
    
    
    
    <span class="code" data-ice="name">Meta</span><span class="code" data-ice="signature">: <span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a></span></span>
    <span class="right-info">
      
      
      <span data-ice="source"><span><a href="file/src/_typeDefs.js.html#lineNumberundefined">source</a></span></span>
    </span>
  </h3>

  
  
  
  <div data-ice="description"><p>A plain object that is shared for the given request. It is passed to all policies that execute for the given
store method, which can read and mutate it freely, and passed into the given store method. The meta object can be
used to add non-serializable data that is useful in the store method, data that is tangentially related to the
request but does not belong in the body (such as information about the current user session), cached results of
policies that may be repeated in an expression, etc.</p>
</div>

  

  <div data-ice="properties">
</div>

  

  

  

  

  

  <div data-ice="example">
    <h4>Example:</h4>
    
  <div class="example-doc" data-ice="exampleDoc">
      
      <pre class="prettyprint source-code"><code data-ice="exampleCode">async function getCurrentUserPolicy(req, res, meta) {
  if (meta.user) {
    // We already have fetched the user (i.e. this policy has probably already been run in this request).
    return
  }
  const authHeader = req.getHeader(&apos;Authorization&apos;)
  if (!authHeader) {
    throw new AutonymError(AutonymError.UNAUTHORIZED, &apos;You must be logged in to perform this action.&apos;)
  }

  const [, token] = authHeader.split(&apos;Bearer &apos;)
  const data = await verify(token)
  // Save data on meta object, which will be accessible on subsequent policies and store methods.
  meta.user = await User.findOne(data.userId)
}

function canCreatePostPolicy(req, res, meta) {
  // Access the user object saved in the previous policy. Note: this means this policy is tightly coupled to the
  // getCurrentUserPolicy and will throw an error if it is used in isolation, which would by default return a 500
  // error. We *could* `await getCurrentUserPolicy(req, res, meta)` here if we wanted to use this policy alone.
  if (!meta.user.privileges.includes(&apos;createPost&apos;)) {
    throw new AutonymError(AutonymError.FORBIDDEN, &apos;You must have the createPost privilege to perform this action.&apos;)
  }
}

const Post = new Model({
  name: &apos;post&apos;,
  policies: {
    create: { and: [getCurrentUserPolicy, canCreatePostPolicy] },
  },
  store: {
    // Since the `getCurrentUserPolicy` was called before inserting, the `user` object is available in the store
    // methods. If calling the API programmatically, e.g. `Post.create()`, this data will need to be supplied
    // manually in the `create` method, since policies are not called when using the model instance directly.
    create: (data, meta) =&gt; Db.insert({ ...data, authorId: meta.user.id }),
  }
})</code></pre>
    </div>
</div>

  

  
  
</div>
<div class="detail" data-ice="detail">
  <h3 data-ice="anchor" id="static-typedef-ModelPolicies">
    <span class="access" data-ice="access">public</span>
    
    
    
    
    
    <span class="code" data-ice="name">ModelPolicies</span><span class="code" data-ice="signature">: <span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a></span></span>
    <span class="right-info">
      
      
      <span data-ice="source"><span><a href="file/src/_typeDefs.js.html#lineNumberundefined">source</a></span></span>
    </span>
  </h3>

  
  
  
  <div data-ice="description"><p>An object mapping store method names to policy hooks. The hooks will be run for the given method. If the value is
just <code>true</code>, it is assumed that all requests will be honored and no policies are necessary for any lifecycle event;
if just <code>false</code>, it is assumed no requests will be honored.</p>
</div>

  

  <div data-ice="properties"><div data-ice="properties">
  <h4 data-ice="title">Properties:</h4>
  <table class="params">
    <thead>
    <tr><td>Name</td><td>Type</td><td>Attribute</td><td>Description</td></tr>
    </thead>
    <tbody>
    
    <tr data-ice="property" data-depth="0">
      <td data-ice="name" class="code" data-depth="0">create</td>
      <td data-ice="type" class="code"><span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a></span> | <span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean">boolean</a></span></td>
      <td data-ice="appendix"><ul><li>optional</li></ul></td>
      <td data-ice="description"><p>Policies to run for the <code>create</code> method.</p>
</td>
    </tr>
<tr data-ice="property" data-depth="1">
      <td data-ice="name" class="code" data-depth="1">create.preSchema</td>
      <td data-ice="type" class="code"><span><a href="typedef/index.html#static-typedef-Operand">Operand</a></span></td>
      <td data-ice="appendix"><ul><li>optional</li></ul></td>
      <td data-ice="description"><p>An expression to evaluate before the data is validated against the schema.</p>
</td>
    </tr>
<tr data-ice="property" data-depth="1">
      <td data-ice="name" class="code" data-depth="1">create.postSchema</td>
      <td data-ice="type" class="code"><span><a href="typedef/index.html#static-typedef-Operand">Operand</a></span></td>
      <td data-ice="appendix"><ul><li>optional</li></ul></td>
      <td data-ice="description"><p>An expression to evaluate after the data is validated against the schema.</p>
</td>
    </tr>
<tr data-ice="property" data-depth="1">
      <td data-ice="name" class="code" data-depth="1">create.preStore</td>
      <td data-ice="type" class="code"><span><a href="typedef/index.html#static-typedef-Operand">Operand</a></span></td>
      <td data-ice="appendix"><ul><li>optional</li></ul></td>
      <td data-ice="description"><p>An expression to evaluate before the data is passed to the store method.</p>
</td>
    </tr>
<tr data-ice="property" data-depth="1">
      <td data-ice="name" class="code" data-depth="1">create.postStore</td>
      <td data-ice="type" class="code"><span><a href="typedef/index.html#static-typedef-Operand">Operand</a></span></td>
      <td data-ice="appendix"><ul><li>optional</li></ul></td>
      <td data-ice="description"><p>An expression to evaluate after the store method has completed.</p>
</td>
    </tr>
<tr data-ice="property" data-depth="0">
      <td data-ice="name" class="code" data-depth="0">find</td>
      <td data-ice="type" class="code"><span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a></span> | <span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean">boolean</a></span></td>
      <td data-ice="appendix"><ul><li>optional</li></ul></td>
      <td data-ice="description"><p>Policies to run for the <code>find</code> method.</p>
</td>
    </tr>
<tr data-ice="property" data-depth="1">
      <td data-ice="name" class="code" data-depth="1">find.preStore</td>
      <td data-ice="type" class="code"><span><a href="typedef/index.html#static-typedef-Operand">Operand</a></span></td>
      <td data-ice="appendix"><ul><li>optional</li></ul></td>
      <td data-ice="description"><p>An expression to evaluate before the data is passed to the store method.</p>
</td>
    </tr>
<tr data-ice="property" data-depth="1">
      <td data-ice="name" class="code" data-depth="1">find.postStore</td>
      <td data-ice="type" class="code"><span><a href="typedef/index.html#static-typedef-Operand">Operand</a></span></td>
      <td data-ice="appendix"><ul><li>optional</li></ul></td>
      <td data-ice="description"><p>An expression to evaluate after the store method has completed.</p>
</td>
    </tr>
<tr data-ice="property" data-depth="0">
      <td data-ice="name" class="code" data-depth="0">findOne</td>
      <td data-ice="type" class="code"><span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a></span> | <span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean">boolean</a></span></td>
      <td data-ice="appendix"><ul><li>optional</li></ul></td>
      <td data-ice="description"><p>Policies to run for the <code>findOne</code> method.</p>
</td>
    </tr>
<tr data-ice="property" data-depth="1">
      <td data-ice="name" class="code" data-depth="1">findOne.preStore</td>
      <td data-ice="type" class="code"><span><a href="typedef/index.html#static-typedef-Operand">Operand</a></span></td>
      <td data-ice="appendix"><ul><li>optional</li></ul></td>
      <td data-ice="description"><p>An expression to evaluate before the data is passed to the store method.</p>
</td>
    </tr>
<tr data-ice="property" data-depth="1">
      <td data-ice="name" class="code" data-depth="1">findOne.postStore</td>
      <td data-ice="type" class="code"><span><a href="typedef/index.html#static-typedef-Operand">Operand</a></span></td>
      <td data-ice="appendix"><ul><li>optional</li></ul></td>
      <td data-ice="description"><p>An expression to evaluate after the store method has completed.</p>
</td>
    </tr>
<tr data-ice="property" data-depth="0">
      <td data-ice="name" class="code" data-depth="0">findOneAndUpdate</td>
      <td data-ice="type" class="code"><span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a></span> | <span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean">boolean</a></span></td>
      <td data-ice="appendix"><ul><li>optional</li></ul></td>
      <td data-ice="description"><p>Policies to run for the <code>findOneAndUpdate</code> method.</p>
</td>
    </tr>
<tr data-ice="property" data-depth="1">
      <td data-ice="name" class="code" data-depth="1">findOneAndUpdate.preSchema</td>
      <td data-ice="type" class="code"><span><a href="typedef/index.html#static-typedef-Operand">Operand</a></span></td>
      <td data-ice="appendix"><ul><li>optional</li></ul></td>
      <td data-ice="description"><p>An expression to evaluate before the data is validated against the
schema.</p>
</td>
    </tr>
<tr data-ice="property" data-depth="1">
      <td data-ice="name" class="code" data-depth="1">findOneAndUpdate.postSchema</td>
      <td data-ice="type" class="code"><span><a href="typedef/index.html#static-typedef-Operand">Operand</a></span></td>
      <td data-ice="appendix"><ul><li>optional</li></ul></td>
      <td data-ice="description"><p>An expression to evaluate after the data is validated against the
schema.</p>
</td>
    </tr>
<tr data-ice="property" data-depth="1">
      <td data-ice="name" class="code" data-depth="1">findOneAndUpdate.preStore</td>
      <td data-ice="type" class="code"><span><a href="typedef/index.html#static-typedef-Operand">Operand</a></span></td>
      <td data-ice="appendix"><ul><li>optional</li></ul></td>
      <td data-ice="description"><p>An expression to evaluate before the data is passed to the store
method.</p>
</td>
    </tr>
<tr data-ice="property" data-depth="1">
      <td data-ice="name" class="code" data-depth="1">findOneAndUpdate.postStore</td>
      <td data-ice="type" class="code"><span><a href="typedef/index.html#static-typedef-Operand">Operand</a></span></td>
      <td data-ice="appendix"><ul><li>optional</li></ul></td>
      <td data-ice="description"><p>An expression to evaluate after the store method has completed.</p>
</td>
    </tr>
<tr data-ice="property" data-depth="0">
      <td data-ice="name" class="code" data-depth="0">findOneAndDelete</td>
      <td data-ice="type" class="code"><span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a></span> | <span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean">boolean</a></span></td>
      <td data-ice="appendix"><ul><li>optional</li></ul></td>
      <td data-ice="description"><p>Policies to run for the <code>findOneAndDelete</code> method.</p>
</td>
    </tr>
<tr data-ice="property" data-depth="1">
      <td data-ice="name" class="code" data-depth="1">findOneAndDelete.preStore</td>
      <td data-ice="type" class="code"><span><a href="typedef/index.html#static-typedef-Operand">Operand</a></span></td>
      <td data-ice="appendix"><ul><li>optional</li></ul></td>
      <td data-ice="description"><p>An expression to evaluate before the data is passed to the store
method.</p>
</td>
    </tr>
<tr data-ice="property" data-depth="1">
      <td data-ice="name" class="code" data-depth="1">findOneAndDelete.postStore</td>
      <td data-ice="type" class="code"><span><a href="typedef/index.html#static-typedef-Operand">Operand</a></span></td>
      <td data-ice="appendix"><ul><li>optional</li></ul></td>
      <td data-ice="description"><p>An expression to evaluate after the store method has completed.</p>
</td>
    </tr>
</tbody>
  </table>
</div>
</div>

  

  

  

  

  

  <div data-ice="example">
    <h4>Example:</h4>
    
  <div class="example-doc" data-ice="exampleDoc">
      
      <pre class="prettyprint source-code"><code data-ice="exampleCode">const Post = new Model({
  name: &apos;post&apos;,
  policies: {
    create: {
      // Users must be logged in and have the proper permission to create a post
      preSchema: { and: [getCurrentUserPolicy, canCreatePostPolicy] },
      // Once the post is validated, it is safe to read and manipulate the request data
      postSchema: trimPostBodyPolicy,
    },
    find: {
      // All requests to get all posts should include a header with the total count
      postStore: addTotalCountHeaderToResponsePolicy,
    },
    findOneAndUpdate: {
      // Users must be logged in and own the post that they are trying to update
      preSchema: { and: [getCurrentUserPolicy, userIsOwnerOfPostPolicy] },
      postSchema: trimPostBodyPolicy,
    },
    findOneAndDelete: {
      preStore: { and: [getCurrentUserPolicy, userIsOwnerOfPostPolicy] },
    },
  },
  store: {},
})</code></pre>
    </div>
</div>

  

  
  
</div>
<div class="detail" data-ice="detail">
  <h3 data-ice="anchor" id="static-typedef-NotExpression">
    <span class="access" data-ice="access">public</span>
    
    
    
    
    
    <span class="code" data-ice="name">NotExpression</span><span class="code" data-ice="signature">: <span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a></span></span>
    <span class="right-info">
      
      
      <span data-ice="source"><span><a href="file/src/_typeDefs.js.html#lineNumberundefined">source</a></span></span>
    </span>
  </h3>

  
  
  
  <div data-ice="description"><p>An object with the key <code>not</code> set to an Operand. The expression will only evaluate to true if the result of the
operand is false or throws an error (which will be swallowed). If the result is true or does not throw an error,
a generic error will be thrown, so implement a custom policy if you require a more specific error message.</p>
</div>

  

  <div data-ice="properties"><div data-ice="properties">
  <h4 data-ice="title">Properties:</h4>
  <table class="params">
    <thead>
    <tr><td>Name</td><td>Type</td><td>Attribute</td><td>Description</td></tr>
    </thead>
    <tbody>
    
    <tr data-ice="property" data-depth="0">
      <td data-ice="name" class="code" data-depth="0">not</td>
      <td data-ice="type" class="code"><span><a href="typedef/index.html#static-typedef-Operand">Operand</a></span></td>
      <td data-ice="appendix"></td>
      <td data-ice="description"></td>
    </tr>
</tbody>
  </table>
</div>
</div>

  

  

  

  

  

  

  

  
  
</div>
<div class="detail" data-ice="detail">
  <h3 data-ice="anchor" id="static-typedef-Operand">
    <span class="access" data-ice="access">public</span>
    
    
    
    
    
    <span class="code" data-ice="name">Operand</span><span class="code" data-ice="signature">: <span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Boolean">boolean</a></span> | <span><a href="typedef/index.html#static-typedef-Policy">Policy</a></span> | <span><a href="typedef/index.html#static-typedef-AndExpression">AndExpression</a></span> | <span><a href="typedef/index.html#static-typedef-OrExpression">OrExpression</a></span> | <span><a href="typedef/index.html#static-typedef-NotExpression">NotExpression</a></span></span>
    <span class="right-info">
      
      
      <span data-ice="source"><span><a href="file/src/_typeDefs.js.html#lineNumberundefined">source</a></span></span>
    </span>
  </h3>

  
  
  
  <div data-ice="description"><p>An operand is a boolean (to explicitly allow or deny) or a policy function, or an AndExpression, OrExpression, or
NotExpression, which can be used to assemble more complex policies out of a series of policy functions.
AndExpressions, OrExpressions, and NotExpressions may be nested recursively. For details, see the documentation
of <a href="https://github.com/mmiller42/async-boolean-expression-evaluator">async-boolean-expression-evaluator</a>.</p>
</div>

  

  <div data-ice="properties">
</div>

  

  

  

  

  

  

  

  
  
</div>
<div class="detail" data-ice="detail">
  <h3 data-ice="anchor" id="static-typedef-OrExpression">
    <span class="access" data-ice="access">public</span>
    
    
    
    
    
    <span class="code" data-ice="name">OrExpression</span><span class="code" data-ice="signature">: <span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a></span></span>
    <span class="right-info">
      
      
      <span data-ice="source"><span><a href="file/src/_typeDefs.js.html#lineNumberundefined">source</a></span></span>
    </span>
  </h3>

  
  
  
  <div data-ice="description"><p>An object with the key <code>or</code> set to an array of Operands. The expression will only evaluate to true if at least
one of the operands is true or does not throw an error. The error of the last policy that throws will be used,
and short-circuiting will prevent further policies from executing when one does not throw.</p>
</div>

  

  <div data-ice="properties"><div data-ice="properties">
  <h4 data-ice="title">Properties:</h4>
  <table class="params">
    <thead>
    <tr><td>Name</td><td>Type</td><td>Attribute</td><td>Description</td></tr>
    </thead>
    <tbody>
    
    <tr data-ice="property" data-depth="0">
      <td data-ice="name" class="code" data-depth="0">or</td>
      <td data-ice="type" class="code"><span><span><a href="typedef/index.html#static-typedef-Operand">Operand</a></span><span>[]</span></span></td>
      <td data-ice="appendix"></td>
      <td data-ice="description"></td>
    </tr>
</tbody>
  </table>
</div>
</div>

  

  

  

  

  

  

  

  
  
</div>
<div class="detail" data-ice="detail">
  <h3 data-ice="anchor" id="static-typedef-Policy">
    <span class="access" data-ice="access">public</span>
    
    
    
    
    
    <span class="code" data-ice="name">Policy</span><span class="code" data-ice="signature">: <span><span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function">function</a></span><span>(req: <span>AutonymReq</span>, res: <span>AutonymRes</span>, meta: <span><a href="typedef/index.html#static-typedef-Meta">Meta</a></span>)</span>: <span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise">Promise</a></span>&lt;<span>*</span>, <span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error">Error</a></span>&gt;</span> | <span>*</span></span>
    <span class="right-info">
      
      
      <span data-ice="source"><span><a href="file/src/_typeDefs.js.html#lineNumberundefined">source</a></span></span>
    </span>
  </h3>

  
  
  
  <div data-ice="description"><p>A function that is evaluated before a store method. It may modify the request data, validate the data and throw an
error, or determine that the client may not perform this request and throw an error. Policies may be combined in
an expression and applied to various store methods in a model&apos;s configuration.</p>
</div>

  

  <div data-ice="properties">
</div>

  

  

  

  

  

  <div data-ice="example">
    <h4>Example:</h4>
    
  <div class="example-doc" data-ice="exampleDoc">
      
      <pre class="prettyprint source-code"><code data-ice="exampleCode">async function getCurrentUserPolicy(req, res, meta) {
  if (meta.user) {
    // We already have fetched the user (i.e. this policy has probably already been run in this request).
    return
  }
  const authHeader = req.getHeader(&apos;Authorization&apos;)
  if (!authHeader) {
    throw new AutonymError(AutonymError.UNAUTHORIZED, &apos;You must be logged in to perform this action.&apos;)
  }

  const [, token] = authHeader.split(&apos;Bearer &apos;)
  const data = await verify(token)
  // Save data on meta object, which will be accessible on subsequent policies and store methods.
  meta.user = await User.findOne(data.userId)
}</code></pre>
    </div>
<div class="example-doc" data-ice="exampleDoc">
      
      <pre class="prettyprint source-code"><code data-ice="exampleCode">function canCreatePostPolicy(req, res, meta) {
  // Access the user object saved in the previous policy. Note: this means this policy is tightly coupled to the
  // getCurrentUserPolicy and will throw an error if it is used in isolation, which would by default return a 500
  // error. We *could* `await getCurrentUserPolicy(req, res, meta)` here if we wanted to use this policy alone.
  if (!meta.user.privileges.includes(&apos;createPost&apos;)) {
    throw new AutonymError(AutonymError.FORBIDDEN, &apos;You must have the createPost privilege to perform this action.&apos;)
  }
}</code></pre>
    </div>
<div class="example-doc" data-ice="exampleDoc">
      
      <pre class="prettyprint source-code"><code data-ice="exampleCode">function userIsOwnerOfPostPolicy(req, res, meta) {
  if (req.getId() !== req.meta.user.id) {
    throw new AutonymError(AutonymError.FORBIDDEN, &apos;You are not the owner of this post.&apos;)
  }
}</code></pre>
    </div>
<div class="example-doc" data-ice="exampleDoc">
      
      <pre class="prettyprint source-code"><code data-ice="exampleCode">function trimPostBodyPolicy(req, res, meta) {
  // If this policy is in the postSchema hook, it is safe to get and set data.
  req.setData({ body: req.getData().body.trim() })
}</code></pre>
    </div>
<div class="example-doc" data-ice="exampleDoc">
      
      <pre class="prettyprint source-code"><code data-ice="exampleCode">Post.count = () =&gt; Db.selectCount(&apos;posts&apos;)

async function addTotalCountHeaderToResponsePolicy(req, res, meta) {
  // If this policy is in the postStore hook, it is safe to get and modify the response data.

  const model = req.getModel()
  if (model.count) {
    const totalCount = await req.getModel().count()
    res.setHeader(&apos;X-Total-Count&apos;, totalCount)
  }
}</code></pre>
    </div>
</div>

  

  
  
</div>
<div class="detail" data-ice="detail">
  <h3 data-ice="anchor" id="static-typedef-Record">
    <span class="access" data-ice="access">public</span>
    
    
    
    
    
    <span class="code" data-ice="name">Record</span><span class="code" data-ice="signature">: <span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a></span></span>
    <span class="right-info">
      
      
      <span data-ice="source"><span><a href="file/src/_typeDefs.js.html#lineNumberundefined">source</a></span></span>
    </span>
  </h3>

  
  
  
  <div data-ice="description"><p>An object that represents a record that may be operated on by a model. A record may be partial (e.g. if it is
the properties to update in a findOneAndUpdate request). If it is the result of a store method, it should at
least have an <code>id</code> property.</p>
</div>

  

  <div data-ice="properties">
</div>

  

  

  

  

  

  

  

  
  
</div>
<div class="detail" data-ice="detail">
  <h3 data-ice="anchor" id="static-typedef-Schema">
    <span class="access" data-ice="access">public</span>
    
    
    
    
    
    <span class="code" data-ice="name">Schema</span><span class="code" data-ice="signature">: <span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a></span></span>
    <span class="right-info">
      
      
      <span data-ice="source"><span><a href="file/src/_typeDefs.js.html#lineNumberundefined">source</a></span></span>
    </span>
  </h3>

  
  
  
  <div data-ice="description"><p>A JSON schema object. <a href="http://json-schema.org/">Read more about JSON Schema</a></p>
</div>

  

  <div data-ice="properties">
</div>

  

  

  

  

  

  

  

  
  
</div>
<div class="detail" data-ice="detail">
  <h3 data-ice="anchor" id="static-typedef-SerializedRecord">
    <span class="access" data-ice="access">public</span>
    
    
    
    
    
    <span class="code" data-ice="name">SerializedRecord</span><span class="code" data-ice="signature">: <span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a></span></span>
    <span class="right-info">
      
      
      <span data-ice="source"><span><a href="file/src/_typeDefs.js.html#lineNumberundefined">source</a></span></span>
    </span>
  </h3>

  
  
  
  <div data-ice="description"><p>A Record that has been transformed by the serialize function as a matter of convenience. It is only used in the
store methods and is always unserialized back into a Record before being passed onto other code outside the
store methods.</p>
</div>

  

  <div data-ice="properties">
</div>

  

  

  

  

  

  

  

  
  
</div>
<div class="detail" data-ice="detail">
  <h3 data-ice="anchor" id="static-typedef-Store">
    <span class="access" data-ice="access">public</span>
    
    
    
    
    
    <span class="code" data-ice="name">Store</span><span class="code" data-ice="signature">(serialize: <span><span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function">function</a></span><span>(data: <span><a href="typedef/index.html#static-typedef-Record">Record</a></span>)</span>: <span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise">Promise</a></span>&lt;<span><a href="typedef/index.html#static-typedef-SerializedRecord">SerializedRecord</a></span>, <span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error">Error</a></span>&gt;</span> | <span><a href="typedef/index.html#static-typedef-SerializedRecord">SerializedRecord</a></span>, unserialize: <span><span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function">function</a></span><span>(data: <span><a href="typedef/index.html#static-typedef-SerializedRecord">SerializedRecord</a></span>)</span>: <span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise">Promise</a></span>&lt;<span><a href="typedef/index.html#static-typedef-Record">Record</a></span>, <span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error">Error</a></span>&gt;</span> | <span><a href="typedef/index.html#static-typedef-Record">Record</a></span>): <span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a></span></span>
    <span class="right-info">
      
      
      <span data-ice="source"><span><a href="file/src/_typeDefs.js.html#lineNumberundefined">source</a></span></span>
    </span>
  </h3>

  
  
  
  <div data-ice="description"><p>An object that has methods for CRUD operations for a typical record. It does not matter if this is a plain
object or an instance of a Store class, as long as it has these members on it.</p>
</div>

  

  <div data-ice="properties"><div data-ice="properties">
  <h4 data-ice="title">Properties:</h4>
  <table class="params">
    <thead>
    <tr><td>Name</td><td>Type</td><td>Attribute</td><td>Description</td></tr>
    </thead>
    <tbody>
    
    <tr data-ice="property" data-depth="0">
      <td data-ice="name" class="code" data-depth="0">create</td>
      <td data-ice="type" class="code"><span><span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function">function</a></span><span>(data: <span><a href="typedef/index.html#static-typedef-SerializedRecord">SerializedRecord</a></span>, meta: <span><a href="typedef/index.html#static-typedef-Meta">Meta</a></span>)</span>: <span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise">Promise</a></span>&lt;<span><a href="typedef/index.html#static-typedef-SerializedRecord">SerializedRecord</a></span>, <span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error">Error</a></span>&gt;</span> | <span><a href="typedef/index.html#static-typedef-SerializedRecord">SerializedRecord</a></span></td>
      <td data-ice="appendix"><ul><li>optional</li></ul></td>
      <td data-ice="description"><p>A function called to create a new record.</p>
</td>
    </tr>
<tr data-ice="property" data-depth="0">
      <td data-ice="name" class="code" data-depth="0">find</td>
      <td data-ice="type" class="code"><span><span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function">function</a></span><span>(query: <span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object">object</a></span>, meta: <span><a href="typedef/index.html#static-typedef-Meta">Meta</a></span>)</span>: <span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise">Promise</a></span>&lt;<span><span><a href="typedef/index.html#static-typedef-SerializedRecord">SerializedRecord</a></span><span>[]</span></span>, <span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error">Error</a></span>&gt;</span> | <span><span><a href="typedef/index.html#static-typedef-SerializedRecord">SerializedRecord</a></span><span>[]</span></span></td>
      <td data-ice="appendix"><ul><li>optional</li></ul></td>
      <td data-ice="description"><p>A function called to find records.</p>
</td>
    </tr>
<tr data-ice="property" data-depth="0">
      <td data-ice="name" class="code" data-depth="0">findOne</td>
      <td data-ice="type" class="code"><span><span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function">function</a></span><span>(id: <span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></span>, meta: <span><a href="typedef/index.html#static-typedef-Meta">Meta</a></span>)</span>: <span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise">Promise</a></span>&lt;<span><a href="typedef/index.html#static-typedef-SerializedRecord">SerializedRecord</a></span>, <span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error">Error</a></span>&gt;</span> | <span><a href="typedef/index.html#static-typedef-SerializedRecord">SerializedRecord</a></span></td>
      <td data-ice="appendix"><ul><li>optional</li></ul></td>
      <td data-ice="description"><p>A
function called to find a single record.</p>
</td>
    </tr>
<tr data-ice="property" data-depth="0">
      <td data-ice="name" class="code" data-depth="0">findOneAndUpdate</td>
      <td data-ice="type" class="code"><span><span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function">function</a></span><span>(id: <span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></span>, data: <span><a href="typedef/index.html#static-typedef-SerializedRecord">SerializedRecord</a></span>, completeData: <span><a href="typedef/index.html#static-typedef-SerializedRecord">SerializedRecord</a></span>, meta: <span><a href="typedef/index.html#static-typedef-Meta">Meta</a></span>)</span></span> | <span><a href="typedef/index.html#static-typedef-SerializedRecord">SerializedRecord</a></span></td>
      <td data-ice="appendix"><ul><li>optional</li></ul></td>
      <td data-ice="description"><p>A function called to update a single
record.</p>
</td>
    </tr>
<tr data-ice="property" data-depth="0">
      <td data-ice="name" class="code" data-depth="0">findOneAndDelete</td>
      <td data-ice="type" class="code"><span><span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function">function</a></span><span>(id: <span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String">string</a></span>, meta: <span><a href="typedef/index.html#static-typedef-Meta">Meta</a></span>)</span>: <span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise">Promise</a></span>&lt;<span>*</span>, <span><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Error">Error</a></span>&gt;</span> | <span>*</span></td>
      <td data-ice="appendix"><ul><li>optional</li></ul></td>
      <td data-ice="description"><p>A function called to delete
a single record.</p>
</td>
    </tr>
</tbody>
  </table>
</div>
</div>

  

  

  

  

  

  <div data-ice="example">
    <h4>Example:</h4>
    
  <div class="example-doc" data-ice="exampleDoc">
      
      <pre class="prettyprint source-code"><code data-ice="exampleCode">const Post = new Model({
  name: &apos;post&apos;,
  store: {
    create: data =&gt; Db.insert(&apos;posts&apos;, data),
    find: () =&gt; Db.selectAll(&apos;posts&apos;),
    findOne: id =&gt; Db.selectOne(&apos;posts&apos;, { id }),
    findOneAndUpdate: (id, data) =&gt; Db.updateWhere(&apos;posts&apos;, { id }, data),
    findOneAndDelete: id =&gt; Db.deleteWhere(&apos;posts&apos;, { id }),

    // Column names are the same as properties on the data, but in snake-case
    serialize: data =&gt; mapKeys(data, property =&gt; snakeCase(property)),
    // Properties are the same as column names in the table, but in camel-case
    unserialize: data =&gt; mapKeys(data, columnName =&gt; camelCase(columnName)),
  },
})</code></pre>
    </div>
</div>

  

  
  
</div>
</div>
</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(1.0.2)</span><img src="./image/esdoc-logo-mini-black.png"></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
<script src="https://unpkg.com/es5-shim@4"></script>
<script src="https://unpkg.com/promise-polyfill@6"></script>
<script src="https://unpkg.com/whatwg-fetch@2"></script>
<script src="https://embed.runkit.com"></script>
<script src="https://unpkg.com/react@15/dist/react.js"></script>
<script src="https://unpkg.com/react-dom@15/dist/react-dom.js"></script>
<script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
<script src="https://unpkg.com/codemirror@5"></script>
<script src="https://unpkg.com/codemirror@5/mode/javascript/javascript.js"></script>
<script src="https://unpkg.com/codemirror@5/addon/edit/matchbrackets.js"></script>
<script src="https://unpkg.com/codemirror@5/addon/edit/closebrackets.js"></script>
<script type="text/babel" src="assets/docsAssets/repl.jsx"></script>
</body>
</html>
